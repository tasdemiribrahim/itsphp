<nav role="navigation">
	<ul id="skip">
		<li><a href="#tablo-anchor">TABLOYA GİT</a></li>
		<li><a href="#takvim-anchor">TAKVİME GİT</a></li>
	</ul>		
</nav>
<div id="chart_div"></div>
<script src="http://www.google.com/jsapi"></script>
<script>
	google.load("visualization", "1", {packages:["orgchart"]});
	google.setOnLoadCallback(drawChart);
	function drawChart() {
		var data = new google.visualization.DataTable();
		data.addColumn("string", "akrabaAd");
		data.addColumn("string", "ebeveyn");
		var resim=Array();
		<?php
			foreach ($this->aileListe as $row)
			{
				$liste[$row['id']]=$row['ad'];
				$ebeveyn[$row['id']]=$row['eid'];
				$resim[$row['id']]=getResim($row['id']);
				echo "resim[".$row['id']."]='".$resim[$row['id']]."';\n\r";
			}
			while(list($key,$value)=each($liste))
			{
				echo "data.addRow(['<img src=\"$resim[$key]\" alt=\"$key\" />$value','";
				echo $ebeveyn[$key]==0 ? "" : "<img src=\"".$resim[$ebeveyn[$key]]."\" alt=\"$ebeveyn[$key]\" />".$liste[$ebeveyn[$key]];
				echo "']);\n\r";
			}
		?>
		var chart = new google.visualization.OrgChart(document.getElementById("chart_div"));
		chart.draw(data, {allowHtml:true,allowCollapse:true,nodeClass:"orgChartNode",selectedNodeClass:"orgChartNodeSel"});
	}
</script>
<br class="clear" />
<h3 class="ui-widget ui-widget-header">Aile Tablo</h3>
<a id="tablo-anchor" class="accessibility">Tablo</a>
<table id="datagrid" class="display">
	<thead><tr><th> ID </th><th> İsim </th><th> Ebeveyn </th><th> Özgeçmiş </th><th> Doğum </th><th> Ölüm </th><th> Eşi </th><th> Adres </th><th> TEL </th><th> Mail </th><th> Twitter </th></tr></thead>
	<tbody>
	<?php
		foreach ($this->aile as $row)
		{
			$veri=substr($row['Detay']["tanim"], 0,100);
			echo "<tr class='".($row['Detay']["olum"]=="0000-00-00" ? ($row['Detay']["es"]=="" ? "gradeX" : "gradeA") : "gradeU")."'><td>".$row['id']."</td><td>".$row['ad']."</td><td>".$ebeveyn[$row['id']]."-".$liste[$ebeveyn[$row['id']]]."</td><td>".substr($veri,0,strrpos($veri, " "))."...</td><td>".$row['Detay']["dogum"]."</td><td>".($row['Detay']["olum"]=="0000-00-00"?"":$row['Detay']["olum"])."</td><td>".$row['Detay']["es"]."</td><td>".$row['Detay']["adres"]."</td><td>".($row['Detay']["tel"]==0?"":$row['Detay']["tel"])."</td><td>".$row['Detay']["mail"]."</td><td>".$row['Detay']["twitter"]."</td></tr>\n";
		}
	?>
	</tbody>
</table>
<br class="clear" />
<h3 class="ui-widget ui-widget-header">Doğum Günleri ve Ölüm Yıldönümleri</h3>
<a id="takvim-anchor" class="accessibility">Takvim</a>
<div id="calendar_wrapper" style="height:500px" aria-live="assertive" aria-atomic="true"></div>
</div>

<aside id="rcnt" role=”complementary”>
	<?php echo $this->ara(); ?>
	<div id="liste">
		<h5 class="ui-widget ui-widget-header ui-corner-all">Aile Ağacı</h5>
		<ul>
		<?php
			aileListeDoldur($liste,$ebeveyn,0);
			function aileListeDoldur($liste,$ebeveyn,$aileArray)
			{
				$aileArray=array_keys($ebeveyn,$aileArray);
				foreach($aileArray as $value)
				{
					$ulEkle=array_keys($ebeveyn,$value);
					echo "\n\r<li>".$liste[$value];
					if($ulEkle)	
					{	
						echo "<ul>";
						aileListeDoldur($liste,$ebeveyn,$value);
						echo "</ul></li>";
					}
					else echo "</li>";
				}
			}
		?>
		</ul>
	</div>
